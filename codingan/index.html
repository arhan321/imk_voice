<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tebak Warna Ceria</title>

    <!-- Google Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" integrity="sha512-v85J3qLhMSFs2s+zgIltrvdUHsEjGpcfEFnGYa1qC3X2I6aXWkLq5kO8K7DzEHu2A4yuAqr0K2Xth6kJtNdx0w==" crossorigin="anonymous" referrerpolicy="no-referrer"/>

    <style>
        /* --------------------------------------------------
           GLOBAL STYLE
        --------------------------------------------------*/
        *,*::before,*::after{box-sizing:border-box}
        body{
            font-family:'Poppins',sans-serif;
            display:flex;justify-content:center;align-items:center;
            height:100vh;margin:0;
            background:linear-gradient(135deg,#f5f7fa 0%,#c3cfe2 100%);
            color:#2c3e50;
        }
        a{color:inherit;text-decoration:none}

        /* --------------------------------------------------
           CARD / GAME CONTAINER
        --------------------------------------------------*/
        .game-container{
            position:relative;
            width:min(90%,460px);
            padding:3.5rem 2.5rem 4rem;
            border-radius:1.75rem;
            background:rgba(255,255,255,0.25);
            backdrop-filter:blur(14px) saturate(180%);
            -webkit-backdrop-filter:blur(14px) saturate(180%);
            border:1px solid rgba(255,255,255,0.35);
            box-shadow:0 25px 45px rgba(0,0,0,.15);
            text-align:center;
            overflow:hidden;
        }
        .game-container::before{
            content:"";
            position:absolute;inset:0;
            background:radial-gradient(circle at top right,rgba(255,255,255,.5),transparent 60%);
            pointer-events:none;
        }

        h1{
            margin:0 0 1rem;
            font-size:clamp(1.5rem,2.5vw+1rem,2rem);
            font-weight:600;
            letter-spacing:.5px;
        }
        #instructions{
            font-size:1rem;line-height:1.55;
            color:#34495e;
            min-height:3.2rem;
            margin-bottom:1.75rem;
        }

        /* --------------------------------------------------
           GAME CIRCLE
        --------------------------------------------------*/
        #game-circle{
            width:200px;height:200px;margin-inline:auto;
            border-radius:50%;
            background:#bdc3c7; /* default */
            border:10px solid #ffffffcc;
            box-shadow:0 8px 15px rgba(0,0,0,.1),inset 0 4px 8px rgba(0,0,0,.08);
            transition:background .45s ease,transform .3s ease;
        }
        .correct-animation{animation:pulse .8s ease}
        @keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}

        /* --------------------------------------------------
           FEEDBACK TEXT
        --------------------------------------------------*/
        .feedback-correct{color:#27ae60;font-weight:600;}
        .feedback-wrong{color:#e74c3c;font-weight:600;}

        /* --------------------------------------------------
           SCORE BADGE
        --------------------------------------------------*/
        #score-display{
            margin-top:2rem;font-size:1.25rem;font-weight:600;
            color:#2c3e50;
        }
        #score-display span{
            display:inline-block;
            min-width:2.5rem;text-align:center;
            padding:.2rem .65rem;
            border-radius:.75rem;
            background:#ffffffaa;
            backdrop-filter:blur(6px);
        }

        /* --------------------------------------------------
           BUTTONS
        --------------------------------------------------*/
        .btn{
            display:inline-flex;align-items:center;gap:.65rem;
            background:linear-gradient(135deg,#3498db 0%,#647BFF 100%);
            color:#fff;font-size:1rem;font-weight:600;
            padding:.85rem 2.5rem;
            border:none;border-radius:999px;
            cursor:pointer;
            box-shadow:0 8px 20px rgba(0,0,0,.15);
            transition:transform .2s ease,box-shadow .2s ease;
        }
        .btn:hover{transform:translateY(-2px);box-shadow:0 12px 24px rgba(0,0,0,.18)}
        .btn:active{transform:translateY(0);box-shadow:0 6px 14px rgba(0,0,0,.12)}

        /* --------------------------------------------------
           MIC STATUS / TOAST
        --------------------------------------------------*/
        #mic-status{
            margin-top:1.25rem;min-height:1.5rem;
            font-size:.95rem;color:#7f8c8d;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1><i class="fa-solid fa-palette"></i> Tebak Warna Ceria</h1>
        <p id="instructions">Klik tombol <strong>Mulai</strong> dan sebutkan warna lingkaran!</p>

        <div id="game-circle"></div>

        <!-- STATUS LISTEN / ERROR -->
        <div id="mic-status"></div>

        <button id="start-btn" class="btn"><i class="fa-solid fa-microphone"></i> Mulai Permainan</button>

        <div id="score-display">Skor : <span id="score-value">0</span></div>
    </div>


    <script>
        // --------------------------------------------------
        //   VARIABEL DOM
        // --------------------------------------------------
        const startBtn=document.getElementById('start-btn');
        const gameCircle=document.getElementById('game-circle');
        const instructions=document.getElementById('instructions');
        const scoreValue=document.getElementById('score-value');
        const micStatus=document.getElementById('mic-status');

        // --------------------------------------------------
        //   SPEECH RECOGNITION SETUP
        // --------------------------------------------------
        const SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition;
        if(!SpeechRecognition){
            alert('Maaf, browsermu tidak mendukung kontrol suara. Coba gunakan Google Chrome.');
            startBtn.disabled=true;startBtn.classList.add('disabled');
        }

        const recognition=new SpeechRecognition();
        recognition.lang='id-ID';
        recognition.continuous=false;
        recognition.interimResults=false;

        // --------------------------------------------------
        //   SPEECH SYNTHESIS HELPER
        // --------------------------------------------------
        const speak=text=>{
            if(!('speechSynthesis'in window))return;
            window.speechSynthesis.cancel();
            const uttr=new SpeechSynthesisUtterance(text);
            uttr.lang='id-ID';
            window.speechSynthesis.speak(uttr);
        };

        // --------------------------------------------------
        //   DATA WARNA
        // --------------------------------------------------
        const colors=[
            {name:'merah',code:'#e74c3c'},
            {name:'biru',code:'#3498db'},
            {name:'hijau',code:'#2ecc71'},
            {name:'kuning',code:'#f1c40f'},
            {name:'ungu',code:'#9b59b6'},
            {name:'jingga',code:'#e67e22'}, // oranye
            {name:'hitam',code:'#34495e'},
            {name:'merah muda',code:'#ff79c6'} // pink
        ];

        // --------------------------------------------------
        //   GAME LOGIC
        // --------------------------------------------------
        let currentColor={};
        let score=0;
        let gameRunning=false;

        const newRound=()=>{
            let next;
            do{next=colors[Math.floor(Math.random()*colors.length)]}while(next.name===currentColor.name);
            currentColor=next;
            gameCircle.style.backgroundColor=currentColor.code;
            instructions.textContent='Sebutkan warna lingkaran ini!';
            instructions.className='';
            micStatus.textContent='Mendengarkan…';
            setTimeout(()=>recognition.start(),250);
        };

        const checkAnswer=spoken=>{
            const guess=spoken.toLowerCase().trim();
            const right=guess.includes(currentColor.name)||
                        (currentColor.name==='jingga'&&guess.includes('oranye'))||
                        (currentColor.name==='merah muda'&&guess.includes('pink'));
            if(right){
                instructions.textContent='Benar! Bagus sekali!';
                instructions.className='feedback-correct';
                score++;scoreValue.textContent=score;
                gameCircle.classList.add('correct-animation');
                speak('Mantap!');
            }else{
                const msg=`Bukan itu warnanya. Ini adalah ${currentColor.name}.`;
                instructions.textContent=msg;instructions.className='feedback-wrong';
                speak(msg);
            }
            setTimeout(()=>gameCircle.classList.remove('correct-animation'),800);
            setTimeout(newRound,2400);
        };

        // --------------------------------------------------
        //   EVENT BINDING
        // --------------------------------------------------
        startBtn.addEventListener('click',()=>{
            if(gameRunning)return;
            gameRunning=true;score=0;scoreValue.textContent=score;
            startBtn.style.display='none';
            newRound();
        });

        recognition.onresult=e=>{
            const spoken=e.results[0][0].transcript;
            micStatus.textContent=`Kamu bilang: "${spoken}"`;
            checkAnswer(spoken);
        };
        recognition.onerror=e=>{
            micStatus.textContent='Error: Tidak bisa mengenali suara. Coba lagi.';
            console.error('Speech recognition error',e.error);
        };
        recognition.onend=()=>{
            if(gameRunning){micStatus.textContent='Memproses…'}else{micStatus.textContent=''}
        };
    </script>
</body>
</html>
